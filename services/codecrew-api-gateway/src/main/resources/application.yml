server:
  port: ${SERVER_PORT:8443}
  compression:
    enabled: true
  shutdown: graceful

management:
  server:
    port: ${MANAGEMENT_PORT:20011}

#logging:
#  level:
#    root: INFO
#    org.springframework.cloud.gateway: TRACE
#    org.springframework.web.reactive: TRACE
##    reactor.netty: TRACE
#    org.springframework.http.server.reactive: TRACE

#logging:
#  level:
#    org.springframework.cloud.gateway.handler.RoutePredicateHandlerMapping: DEBUG
#    org.springframework.cloud.gateway.handler.FilteringWebHandler: DEBUG
#    site.codecrew.apigateway.filter.global.RequestLoggingFilter: INFO
#
#    org.springframework.cloud.gateway.filter.WeightCalculatorWebFilter: INFO
#    org.springframework.web.reactive.result.method.annotation.ResponseEntityResultHandler: INFO
#    org.springframework.http.server.reactive.ReactorHttpHandlerAdapter: INFO
#
#    reactor.netty.resources: DEBUG
#    reactor.netty.http.client: DEBUG
#    reactor.netty.transport: DEBUG
#    io.netty.channel: INFO

spring:
  reactor:
    context-propagation: auto
  application:
    name: codecrew-api-gateway
  config:
    import:
      - logging.yml
      - monitoring.yml
      - classpath:application-cors.yml
      - classpath:application-filter.yml
      - classpath:application-route.yml
  cloud:
    gateway:
      server:
        webflux:
          discovery:
            locator:
              enabled: false
          httpclient:
            connect-timeout: 3000
            pool:
              type: DISABLED
              max-connections: 300
              acquire-timeout: 3000
              max-idle-time: 30s
              max-life-time: 60s
              eviction-interval: 3s
            compression: true
            wiretap: false
            ssl:
              use-insecure-trust-manager: false
              handshake-timeout: 10s
